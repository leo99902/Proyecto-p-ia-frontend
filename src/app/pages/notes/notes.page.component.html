<div class="notes-container">
  <header class="notes-header">
    <h1>Mis Notas</h1>
    <p>Crea y gestiona tus notas personales.</p>
  </header>

  <div class="notes-content">
    <!-- Formulario para crear una nueva nota -->
    <div class="note-form-card">
      <h2>Crear Nueva Nota</h2>
      <form [formGroup]="noteForm" (ngSubmit)="createNote()">
        <div class="form-group">
          <input type="text" formControlName="title" placeholder="Título de la nota">
        </div>
        <div class="form-group">
          <textarea formControlName="content" placeholder="Escribe tu nota aquí..." rows="5"></textarea>
        </div>
        <button type="submit" [disabled]="noteForm.invalid">Guardar Nota</button>
      </form>
    </div>

    <!-- Lista de notas existentes -->
    <div class="notes-list-section">
      <h2>Notas Guardadas</h2>
      @if (isLoading()) {
        <p>Cargando notas...</p>
      } @else if (error()) {
        <p class="error-message">{{ error() }}</p>
      } @else if (notes().length === 0) {
        <p>Aún no tienes notas guardadas. ¡Crea la primera!</p>
      } @else {
        <div class="notes-grid">
          @for (note of notes(); track note._id) {
            <div class="note-card">
              <h3>{{ note.title }}</h3>
              <p>{{ note.content }}</p>
              <button class="delete-btn" (click)="deleteNote(note._id)" title="Eliminar nota"><i class='bx bx-x'></i></button>
              <small>{{ note.createdAt | date:'short' }}</small>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>

<!-- Modal de Confirmación para Eliminar -->
@if (showDeleteModal()) {
  <div class="modal-overlay" (click)="cancelDelete()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Confirmar Eliminación</h2>
      </div>
      <div class="modal-body">
        <p>¿Estás seguro de que quieres eliminar esta nota de forma permanente? Esta acción no se puede deshacer.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-cancel" (click)="cancelDelete()">Cancelar</button>
        <button class="btn btn-confirm" (click)="confirmDelete()">Sí, Eliminar</button>
      </div>
    </div>
  </div>
}